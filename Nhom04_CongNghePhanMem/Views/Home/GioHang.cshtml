@model Nhom04_CongNghePhanMem.Models.GioHangSanPham

@{
    ViewBag.Title = "Giỏ hàng";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

<div class="container py-5">
    <h2 class="mb-4 text-center" style="color:#8B1A3C; font-weight:700;">Giỏ hàng của bạn</h2>

    @if (Model == null || Model.lst.Count == 0)
    {
        <div class="text-center py-5">
            <i class="fa fa-shopping-cart fa-4x text-muted"></i>
            <h4 class="mt-3">Giỏ hàng trống</h4>
            <a href="@Url.Action("SanPham", "Home")" class="btn btn-outline-primary mt-3">← Tiếp tục mua sắm</a>
        </div>
    }
    else
    {
        <div class="row">
            <!-- DANH SÁCH SẢN PHẨM -->
            <div class="col-md-8">
                @foreach (var item in Model.lst)
                {
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body d-flex align-items-center">

                            <!-- Ảnh sản phẩm -->
                            <img src="@Url.Content("~/Content/Images/")@item.vHinhAnh" class="rounded me-3" style="width:120px; height:auto;" />

                            <!-- Thông tin sản phẩm -->
                            <div class="flex-fill">
                                <h5 class="card-title mb-1">@item.vTenSP</h5>
                                <p class="text-danger mb-2">Giá: @item.vGiaBan.ToString("N0") đ</p>


                                <p><strong>Size:</strong> @item.vSize</p>
                                <p>
                                    <strong>Màu:</strong>
                                    
                                    @item.vMau
                                </p>



                                <!-- Số lượng -->
                                <form action="@Url.Action("CapNhatGioHang", "Home")" method="post" class="d-flex align-items-center gap-2">
                                    <input type="hidden" name="id" value="@item.vID_SP" />
                                    <input type="hidden" name="size" value="@item.vSize" />
                                    <input type="hidden" name="mau" value="@item.vMau" />
                                    <button type="submit" name="soLuong" value="@(item.vSoLuong - 1)" class="btn btn-outline-secondary btn-sm">−</button>
                                    <span class="px-2 fw-bold">@item.vSoLuong</span>
                                    <button type="submit" name="soLuong" value="@(item.vSoLuong + 1)" class="btn btn-outline-secondary btn-sm">+</button>
                                </form>

                            </div>

                            <!-- Nút xóa -->
                            <div class="ms-3">
                                <a href="@Url.Action("XoaKhoiGio", "Home", new { id = item.vID_SP, size = item.vSize, mau = item.vMau })" class="btn btn-outline-danger">
                                    ✖
                                </a>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <!-- ORDER SUMMARY -->
            <div class="col-md-4">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title mb-3">Tóm tắt đơn hàng</h5>

                        <div class="d-flex justify-content-between mb-2">
                            <span>Subtotal</span>
                            <span>@Model.TongThanhTien().ToString("N0") đ</span>
                        </div>

                        <div class="d-flex justify-content-between mb-2">
                            <span>Discount</span>
                            <span>-0 đ</span>
                        </div>

                        <div class="d-flex justify-content-between mb-2">
                            <span>Delivery fee</span>
                            <span>0 đ</span>
                        </div>

                        <hr />

                        <div class="d-flex justify-content-between fw-bold">
                            <span>Total</span>
                            <span>@Model.TongThanhTien().ToString("N0") đ</span>
                        </div>

                        <a href="@Url.Action("ThanhToan", "Home")" class="btn btn-danger w-100 mt-3">Thanh toán</a>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

<style>
    .badge {
        min-width: 30px;
        display: inline-block;
        height: 20px;
        border-radius: 4px;
    }
</style>
